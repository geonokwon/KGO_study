# AWS EC2 생성
1. 왼쪽 상단 검색창에 EC2 검색 -> 선택

2. EC2 대시보드로 이동

3. 왼쪽 메뉴에서 인스턴스 -> 인스턴스 클릭

4. 오른쪽 상단의 '인스턴스 시작' 클릭

5. 인스턴스 시작 창으로 이동
- 이름 : webServer
- AMI(Aamazon Machine Image)
  Amazon Linux 2023 AMI -> Amazon Linux 2 AMI로 변경
- 인스턴스 유형 : t2.micro(기본값)

※ 인스턴스 유형
- 머신의 용도를 결정
- CPU, 메모리, 스토리지, 네트워크 용량 등이 용도 맞게 조합이 되어 있음
- 용도는 5가지로 구분
=> 범용, 컴퓨팅 최적화, 메모리 최적화, 가속화된 컴퓨팅 최적화, 스토리지 최적화
범용 : A1, T2, T3, M5, M5a, M4, T3a
컴퓨팅 최적화 : C5, C5n, C4
메모리 최적화 : R5, R5a, R4, X1e X1
가속화된 컴퓨팅 최적화 : P3, P2, G3, F1
스토리지 최적화 : H3, I3, D2

6. 키페어(로그인)
- AWS에서 보안을 위해 키 설정이 필요!(필수)
- 새 키 페어 생성
   키 페어 이름 : class1_key
   키 페어 유형 : RSA
   프라이빗 키 파일 형식 : .pem
=> 입력 및 선택 후 \[ 키 페어 생성 ] 클릭
★ 주의사항! 재발급이 되지 않음!!
=> 다운로드 폴더에 저장되는 파일 -> D: 아래로 이동!!

7. 네트워크 설정 -> \[편집] 클릭
- 보안 그룹 이름 : ssh
- 설명 : ssh
- 유형 : ssh(기본값)
- 프로토콜 : TCP(변경불가)
- 포트범위 : 22(변경불가)

8. 스토리지 구성
- 1 x 8GiB gp2 루트 볼륨(기본값)

9. 오른쪽 요약 페이지 확인 후 \[인스턴스 시작] 버튼 클릭

10. \[모든 인스턴스 보기] 클릭

※ 생성 후 자동으로 인스턴스가 시작됨!

##  AWS EC2 인스턴스 원격(Remote) 접속 
1. 원격 접속을 위해서는 원격 접속 프로그램 필요
=> 수업 시 설치한 MobaXterm 프로그램 사용

2. 인스턴스 -> 인스턴스 -> webServer 체크
=> 퍼블릭 IPv4 주소 복사
=> 왼쪽의 네모(네모) 버튼 클릭하면 복사됨

3. 다시 MobaXterm 으로 돌아옴
=> 왼쪽 상단의 Session -> SSH -> Remote Host 항목에 복사한 주소를 붙여넣기

4. 아래쪽의 Advanced SSH settings 탭 클릭
=> □Use private key 체크 -> 오른쪽 파일모양 버튼 클릭
=> AWS EC2 인스턴스 설치 중 생성한 키페어 파일을 선택
     (D:\class1_key.pem)

5. Bookmark settings 탭 클릭
=> Session name : 기본값으로 IP주소가 설정되어 있음
=> Session name을 webServer로 변경

6. 설정이 완료되면 \OK] 버튼 클릭. webServer를 더블 클릭
=> Accecpt 클릭
========================================
\[ 원격 접속 ]
login as : ec2-user
=> 접속 완료
※ AWS EC2는 보안을 위해 root 사용자 접속을 하지 못하도록 설정이 되어 있음

##  간단한 webServer 동작 시키기 
1. 웹 서버로 동작하기 위해서는 웹 서버용 프로그램 필요

2. 아파치 웹 서비스 프로그램을 설치

3. ec2-user 계정은 일반 계정으로 프로그램 설치, 계정 관리 등 관리자 권한이 필요한 명령어 입력 시 앞에 'sudo' 를 붙임

4. 아파치 웹 서비스 설치
sudo yum install -y httpd
=> 아파치 웹 서비스 프로그램 설치

rpm -qa httpd
=> 아파치 웹 서비스 설치 확인
=> 아무 내용이 나오지 않으면 설치가 되지 않은 것!

sudo systemctl start httpd
=> 아파치 웹 서비스를 시작

---
\[ 접속 확인 ]
1. 윈도우 웹 브라우저에서 복사한 퍼블릭 IPv4 주소를 입력
=> 접속이 안됨!!
=> 방화벽 때문에 외부에서 접근이 차단되어 있음

2. AWS에서 방화벽 설정 시 EC2 인스턴스 내부에서 firewall-cmd 명령어로 설정할 수 없다!!
=> 웹 페이지에서 설정!!

3. EC2 대시보드 이동 -> 왼쪽 메뉴 중 '네트워크 및 보안' -> '보안 그룹' 클릭 -> 오른쪽 상단의 \[보안 그룹 생성] 클릭
※ 머신을 기준으로 들어오는 제어를 인바운드, 머신을 나갈 때 제어는 아웃바운드
클라이언트가 현재 웹페이지를 서버에게 요청을 하는 경우이니 인바운드 규칙 필요

보안 그룹 이름 : web
설명 : web
=> 인바운드 규칙 추가
=> 유형 : HTTP, 프로토콜 : TCP(변경불가), 포트:80(변경불가)
=> 소스 : Anywhere-IPv4(모든 IP주소 허용) 0.0.0.0/0 표현됨
=> 설정이 완료되면 \[보안 그룹 생성] 버튼 클릭!

4. 생성된 web 보안 그룹을 webServer 인스턴스에 적용
=> EC2 대시보드 -> 인스턴스 -> 인스턴스 
=> webServer 항목에서 우클릭 -> 보안 -> 보안그룹 변경
=> 연결된 보안 그룹을 보면 ssh 하나만 보임.
=> 보안 그룹 선택 창을 클릭하면 3번에서 생성한 web 보안 그룹이 보임
=> 선택 후 오른쪽 \[보안 그룹 추가] 버튼 클릭 -> 아래쪽에 web이 추가
=> 추가가 되었다면 \[저장] 버튼 클릭

5. 다시 윈도우 웹 브라우저에서 새로고침(F5)을 하면
=> Test Page가 보임! 웹 서비스는 정상

6. MobaXterm으로 이동, 시작 페이지 설정
sudo vi /var/www/html/index.html
=> 'i' 입력 -> 입력모드 변경 -> 적당한 내용을 입력
=> esc -> :wq 저장 후 빠져나옴

7. 다시 윈도우 웹 브라우저에서 새로고침(F5)을 한다.

